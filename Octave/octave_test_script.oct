##############################
## Testing custom functions ##
##############################


## Add directory of function files to search path (not working due to invalid ELF header):
## addpath("functions/");
## Source function files:
source("functions/van_Genuchten_variables.oct");
source("functions/exp_notation.oct");
## Set graphics toolkit:
graphics_toolkit("gnuplot");
## Set working directory:
cd("/home/renke/home_Projekt/Octave");
## Set function parameters (values taken from Celia et al. (1990), p. 1487 below eq. (13b)):
alpha = 0.03335;
theta_s =0.368;
theta_r = 0.102;
n = 2;
K_s = 0.00922;
h = randi([-1000, -500], 10,1);
## Single execution of “van_Genuchten_variables” (worked as expected on 2016-12-07):
## [K, theta] = van_Genuchten_variables(alpha = alpha,
## n = n,
## theta_r = theta_r,
## theta_s = theta_s,
## K_s = K_s,
## h = h)
## Execution of “van_Genuchten_variables” in for-loop (worked as expected on 2016-12-07):
for timestep = 1:10
  [K(:, timestep), theta(:, timestep)] = van_Genuchten_variables(alpha = alpha,
						     n = n,
						     theta_r = theta_r,
						     theta_s = theta_s,
						     K_s = K_s,
						     h = h);
endfor
## Vary results for plotting:
for column = 1:columns(K)
  K_rand(:,column) = K(:, column) .* randi([1, 10], 1, 1);
endfor
for column = 1:columns(theta)
  theta_rand(:,column) = theta(:, column) .* randi([1, 10], 1, 1);
endfor
## Create vector with values for x-axis:
time = 1:10;

#############################
## Plot “K” against “time” ##
#############################

close all;
figurehandle = figure("papertype",
		  "a4",
		  "paperorientation",
		  "landscape",
		  "paperunits",
		  "centimeters",
		  "paperposition",
		  [2 2 17 25.6],
		  "visible",
		  "off");
		  ## "on");
xlabel("Time [s]");
ylabel("Hydraulic conductivity [cm/s]");
axis([0;
      11;
      min(min(K_rand)) - 1 * (10 ^ -13);
      max(max(K_rand)) + 1 * (10 ^ -9)],
     "tic",
     "label");
## Convert tick labels to “10^” notation (needs some work):
## START CONVERSION
## yt = get(gca,
         ## "ytick");
## [yex,ymant] = exp_notation(yt);
## set(gca,
    ## "yticklabel",
    ## sprintf("%3.3gx10^{%d}|",
## [ymant,yex](:)));
## END CONVERSION
color = ["k"];
linestyle = "-";
linewidth = 2;
markerstyles = ["o";
	      "o";
	      "s";
	      "s";
	      "d";
	      "d";
	      "^";
	      "^";
	      "v";
	      "v"];
markeredgecolor = ["k"];
markerfacecolor = ["auto";
	         "none"];
## Create plots using for-loop:
for row = 1:rows(K_rand)
  line(time,
       ## K_rand(row,:).', ## transposing seems to result in plotting the same line mutlitple times
       K_rand(row,:),
       "linewidth",
       linewidth,
       "linestyle",
       linestyle,
       "color",
       color,
       "marker",
       markerstyles(row),
       "markeredgecolor",
       markeredgecolor,
       "markerfacecolor",
       markerfacecolor(1 .+ rem(row, 2)));
endfor
## Add legend:
legend("Node 01",
       "Node 02",
       "Node 03",
       "Node 04",
       "Node 05",
       "Node 06",
       "Node 07",
       "Node 08",
       "Node 09",
       "Node 10");
system("rm -vf ../Grafiken/K_rand_plot.pdf");
print(figurehandle,
      "../Grafiken/K_rand_plot.pdf");
system("mupdf -r 66 ../Grafiken/K_rand_plot.pdf &");

#################################
## Plot “theta” against “time” ##
#################################

close all;
figurehandle = figure("papertype",
		  "a4",
		  "paperorientation",
		  "landscape",
		  "paperunits",
		  "centimeters",
		  "paperposition",
		  [2 2 17 25.6],
		  "visible",
		  "off");
		  ## "on");
xlabel("Time [s]");
ylabel("Water content [cm^3/cm^3]");
axis([0;
      11;
      min(min(theta_rand)) - 1 * (10 ^ -13);
      max(max(theta_rand)) + 1 * (10 ^ -9)],
     "tic",
     "label");
## Convert tick labels to “10^” notation (needs some work):
## START CONVERSION
## yt = get(gca,
         ## "ytick");
## [yex,ymant] = exp_notation(yt);
## set(gca,
    ## "yticklabel",
    ## sprintf("%3.3gx10^{%d}|",
## [ymant,yex](:)));
## END CONVERSION
color = ["k"];
linestyle = "-";
linewidth = 2;
markerstyles = ["o";
	      "o";
	      "s";
	      "s";
	      "d";
	      "d";
	      "^";
	      "^";
	      "v";
	      "v"];
markeredgecolor = ["k"];
markerfacecolor = ["auto";
	         "none"];
## Create plots using for-loop:
for row = 1:rows(theta_rand)
  line(time,
       ## theta_rand(row,:).', ## transposing seems to result in plotting the same line mutlitple times
       theta_rand(row,:),
       "linewidth",
       linewidth,
       "linestyle",
       linestyle,
       "color",
       color,
       "marker",
       markerstyles(row),
       "markeredgecolor",
       markeredgecolor,
       "markerfacecolor",
       markerfacecolor(1 .+ rem(row, 2)));
endfor
## Add legend:
legend("Node 01",
       "Node 02",
       "Node 03",
       "Node 04",
       "Node 05",
       "Node 06",
       "Node 07",
       "Node 08",
       "Node 09",
       "Node 10");
system("rm -vf ../Grafiken/theta_rand_plot.pdf");
print(figurehandle,
      "../Grafiken/theta_rand_plot.pdf");
system("mupdf -r 66 ../Grafiken/theta_rand_plot.pdf &");
      
## Close all figure windows:
close all;
